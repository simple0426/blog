---
title: pgsql-高可用与负载均衡
tags:
categories:
---
# 方案
* 共享存储：NAS
* （文件系统）块设备复制：DRBD
* 事务日志传送：文件级别的日志传送、流复制
* 基于触发器的主备复制：Slony-I 
* 基于语句复制的中间件：Pgpool-II
* 异步多主复制：Bucardo 
* 同步多主复制：无
* 商业解决方案

## 其他解决方案
* 数据分区（Data Partitioning）：数据拆分后分布式存储，需要使用时再组合返回给终端
* 并行查询【提高查询速度】
    - 原理：将单个sql查询语句拆分成多个部分，分别交给不同后端处理，多个后端的查询结果经过聚合后返回给客户端
    - 实现：Pgpool-II、PL/Proxy

# 在线热备
* 如果使用表空间，因为表空间使用绝对路径的原因，需要主备可以建立相同的路径
* 主备的硬件架构需要一致，比如32或64位系统
* 软件版本，主备大版本要尽可能保持一致，备机小版本高于主是可以的，这是因为高版本可以读取低版本的wal文件

