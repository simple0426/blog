---
title: python正则表达式
tags:
  - 正则表达式
categories:
  - python
date: 2018-05-13 22:33:34
---

# 语法
## 元字符
| 表示法 |               含义               |         注意事项        |
|--------|----------------------------------|-------------------------|
| `.`    | 匹配除换行符（\n）之外的任意字符 | -                       |
| \      | 转义字符                         | -                       |
| [...]  | 一个字符集范围内的任意字符       | 第一个字符为[^]表示取反 |

## 预定义字符
>可用于字符集[...]

| 表示法 |        含义        | 注意事项 |
|--------|--------------------|----------|
| \w     | 任意字母数字下划线 | -        |
| \W     | 非字母和数字       | -        |
| \d     | 数字               | -        |
| \D     | 非数字             | -        |
| \s     | 空白字符           | -        |
| \S     | 非空白字符         | -        |

## 数量词
>可用于字符或分组()之后

| 表示法 |          含义         |                       注意事项                       |
|--------|-----------------------|------------------------------------------------------|
| *      | 匹配前一个字符0或多次 | *?非贪婪模式                                         |
| +      | 匹配前一个字符1或多次 | +?非贪婪模式                                         |
| ?      | 匹配前一个字符0或1次  | ??非贪婪模式                                         |
| `{m}`    | 匹配前一个字符m次     | -                                                    |
| `{m,n}`  | 匹配前一个字符m到n次  | 1. 省略m则0到n次，省略n则m到多次 <br>2. `{m,n}?`非贪婪模式 |

## 边界匹配
| 表示法 |      含义      | 注意事项 |
|--------|----------------|----------|
| ^      | 匹配字符串开头 | -        |
| $      | 匹配字符串结尾 | -        |

## 分组
|     表示法      |      含义      |          注意事项          |
|-----------------|----------------|----------------------------|
| 1【竖线】       | 匹配左边或右边 | 没有括号时，范围是整个正则 |
| （...）         | 分组           | 从左到右依次编号           |
| \n              | 分组引用       | -                          |
| `(?p<name>...)` | 命名分组     | -                          |
| `(?p=name)`     | 引用命名分组 | -                          |

## 不分组构造
|       表示法        |                                               含义                                               |                                                    范例                                                   |
|---------------------|--------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|
| (?:...)             | (...)的不分组表示                                                                                | re.match('(?:abc){2}', 'abcabc')                                                                          |
| (?iLmsux)           | iLmsux的每个字符代表一个匹配模式<br>只能用在正则表达式的开头，可选多个<br>用来替代整体模式的flag | re.match('(?i)abc', 'AbC')                                                                                |
| (?#...)             | #后的内容为注释                                                                                  | re.match('ab(?#ceshi)cd', 'abcd')                                                                         |
| (?=...)             | 之后的字符串匹配表达式才能成功匹配                                                               | re.match('abc(?=ef)', 'abcef') 后面是ef的abc                                                              |
| (?!...)             | 之后的字符串不匹配表达式才能成功匹配                                                             | re.match('abc(?!ef)', 'abce')后面不是ef的abc                                                              |
| (?<=...)            | 之前的字符串匹配表达式才能成功匹配【使用search】                                                 | re.search('(?<=ab)cd', 'abcd')前面是ab的cd                                                                |
| `(?<!...)`          | 之前的字符串不匹配表达式才能成功匹配【使用search】                                               | `re.search('(?<!ab)cd', 'qacd')前面不是ab的cd`                                                            |
| (?(id/name)pattern) | 如果编号为id或别名为name的组匹配到字符<br>，则此分组应用同时需要匹配到pattern                    | re.match('(\d)ab(?(1)\d)', '1ab1')<br>  分组(\d)和表达式之后的分组(?(1)\d)必须同时匹配【1代表第一个分组】 |

# 应用
## re模块
* search：在字符串中进行匹配测试
* findall：在字符串中进行匹配测试，并返回所有匹配的字符串
* match：从字符串开始进行匹配测试，`re.match('\s+', ' ')`
* compile：预编译

```python
user_account = re.compile(r'[\w\.\-]+@([\w\.\-]+)\.[a-z]+$|^0(\d){2,3}(\d){8}$|^1(\d){10}$')
user_account.match('jingqi.he@zj-inv.cn')
```

* split：字符串切分，re.split(r'[\s\,]+', 'a b, c d')
* sub：替换，re.sub(r'\slove\s', ' hate ', 'i love you')

## 经典范例
```python
re.compile(
    r'(^|\s)(' + OPTIONS_REGEX +
    r')=(?P<quote>[\'"])?(.*?)(?(quote)(?<!\\)(?P=quote))((?<!\\)(?=\s)|$)'
)
```

|            表达式             |                                                           含义                                                           |
|-------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| (^/\s)                        | 以竖线开头或空格                                                                                                         |
| `(?P<quote>[\'"])`            | 单或双引号为一个分组                                                                                                     |
| `(?(quote)(?<!\\)(?P=quote))` | 如果前面的单或双引号匹配到，则在上述<br>任意字符串之后必须同时匹配一个相同<br>的单或双引号，并且保证此引号之前没有转义符 |
| ```((?<!\\)(?=\s)/$)```       | 直接以上述匹配结束或是上述匹配之后是空格，并且保证空格之前没有转义符                                                     |
